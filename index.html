<!DOCTYPE html>
<html lang="en" class="dark">
  <head> 
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Music Player</title>
    <link rel="manifest" href="./system/manifest.json" />
    <meta name="theme-color" content="#1C2128" />
    <meta name="description" content="A sleek and modern web-based music player." />
    <meta name="keywords" content="music, player, web, audio, streaming, playlist, songs, albums, artists" />
    <meta name="author" content="ClockBlocked" />
    <meta property="og:title" content="Music Player" />
    <meta property="og:description" content="A sleek and modern web-based music player." />
    <meta property="og:image" content="thumbnail.jpg" />
    <meta property="og:url" content="https://koders.cloud" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Music Player" />
    <meta name="twitter:description" content="A sleek and modern web-based music player." />
    <meta name="twitter:image" content="thumbnail.jpg" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="./global.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/preline@2.0.3/dist/preline.min.css" rel="stylesheet" />
    <link href="https://dev.wuaze.com/styleSheets/fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" />

<style>
.popup-content {
  height: 600px;
  padding: 2rem;
  transition: all 0.65s ease-in-out;
}
.popup-tabs {
  display: flex;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  margin-bottom: 15px;
}

.popup-tab {
  flex: 1;
  padding: 12px 0;
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 500;
  cursor: pointer;
  position: relative;
}

.popup-tab.active {
  color: white;
}

.popup-tab.active::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--accent-color);
}

.popup-tab-content {
  opacity: 1;
  pointer-events: none;
  transition: opacity 0.45s ease-in-out;
}
.popup-tab-content.show {
  opacity: 1;
  pointer-events: auto;
}

.popup-tab-content[data-tab="now-playing"] {
  opacity: 1;
  pointer-events: auto;
  transition: 0.45s ease-in-out;
}
.popup-tab-content[data-tab="queue"].show {
  opacity: 1;
  pointer-events: auto;
   transition: 0.45s ease-in-out;
}
.popup-tab-content[data-tab="recent"].show {
  opacity: 1;
  pointer-events: auto;
   transition: 0.45s ease-in-out;
}

.popup-song-list {
  max-height: 300px;
  overflow-y: auto;
}

.popup-song-item {
  display: flex;
  align-items: center;
  padding: 10px;
  border-radius: 5px;
  cursor: pointer;
}

.popup-song-item:hover {
  background: rgba(255, 255, 255, 0.05);
}

.popup-song-cover {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  margin-right: 12px;
}

.popup-song-info {
  flex: 1;
}

.popup-song-title {
  margin: 0;
  font-size: 14px;
}

.popup-song-artist {
  margin: 0;
  font-size: 12px;
  opacity: 0.7;
}

.popup-song-duration {
  font-size: 12px;
  opacity: 0.7;
}

.content-loading {
  position: absolute;
  inset: 0;
  z-index: 9999;
  background-color: rgba(13, 17, 23, 0.75);
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s ease;
  will-change: opacity;
}

.content-loading.opacity-100 {
  opacity: 1;
  pointer-events: all;
}

.album-image {
    width: 100%;
    height: 200px;
    border-radius: 15px;
}

.artistBottom h3 {
    color: whitesmoke;
    border-radius: 5px;
    padding: 3px 8px;
    opacity: 0.35;
    transition: opacity 0.65s ease-in-out;
    backdrop-filter: blur(20px);
    transform: translate(-15px, -50px);
}

.artistBottom:hover h3 {
    opacity: 1;
}

.artistBottom > p {
    color: whitesmoke;
    border-radius: 5px;
    padding: 3px 8px;
    opacity: 0.35;
    transition: opacity 0.65s ease-in-out 1s;
    backdrop-filter: blur(20px);
    transform: translate(-15px, -50px);
}

.artistBottom:hover p {
    opacity: 1;
}

.empty-state {
  text-align: center;
  padding: 2rem;
  color: rgba(255, 255, 255, 0.5);
  font-size: 0.875rem;
}

.search-dialog {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  z-index: 9999;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: 10vh;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.search-dialog:not(.hidden) {
  opacity: 1;
}

.search-dialog-content {
  background: var(--bg-default);
  border: 1px solid var(--border-default);
  width: 100%;
  max-width: 600px;
  margin: 0 1rem;
}

.search-dialog-opening .search-dialog-content {
  animation: slideInDown 0.4s ease-out;
}

.search-dialog-closing .search-dialog-content {
  animation: slideOutUp 0.3s ease-in;
}

@keyframes slideInDown {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideOutUp {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(-30px);
  }
}






/* Apple Music / YouTube Music Style Song Lists */
.popup-song-list {
  list-style: none;
  padding: 0;
  margin: 0;
  max-height: 300px;
  overflow-y: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.popup-song-list::-webkit-scrollbar {
  display: none;
}

.popup-song-item {
  display: flex;
  align-items: center;
  padding: 8px 16px;
  cursor: pointer;
  transition: background-color 0.15s ease;
  min-height: 56px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.popup-song-item:hover {
  background-color: rgba(255, 255, 255, 0.08);
}

.popup-song-item:active {
  background-color: rgba(255, 255, 255, 0.12);
}

.popup-song-item.playing {
  background-color: rgba(83, 155, 245, 0.1);
}

.popup-song-cover {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  margin-right: 16px;
  object-fit: cover;
  flex-shrink: 0;
  background-color: var(--backgroundMuted);
}

.popup-song-info {
  flex: 1;
  min-width: 0;
  margin-right: 16px;
}

.popup-song-title {
  margin: 0 0 2px 0;
  font-size: 14px;
  font-weight: 400;
  color: var(--textPrimary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.3;
}

.popup-song-item.playing .popup-song-title {
  color: var(--accentPrimary);
  font-weight: 500;
}

.popup-song-artist {
  margin: 0;
  font-size: 12px;
  color: var(--textSecondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.3;
  font-weight: 400;
}

.popup-song-duration {
  font-size: 12px;
  color: var(--textSecondary);
  flex-shrink: 0;
  font-weight: 400;
  min-width: 32px;
  text-align: right;
}

.popup-song-item.playing .popup-song-duration {
  color: var(--accentPrimary);
}

/* Empty state */
.popup-song-list .empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 48px 24px;
  color: var(--textSecondary);
  font-size: 14px;
  text-align: center;
}

.popup-song-list .empty-state::before {
  content: 'â™ª';
  font-size: 32px;
  margin-bottom: 8px;
  opacity: 0.5;
}

/* Playing indicator (small equalizer bars) */
.popup-song-item.playing .popup-song-title::after {
  content: '';
  display: inline-block;
  width: 12px;
  height: 12px;
  margin-left: 8px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23539bf5'%3E%3Cpath d='M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z'/%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
  vertical-align: middle;
}

/* Mobile adjustments */
@media (max-width: 768px) {
  .popup-song-item {
    padding: 8px 12px;
    min-height: 52px;
  }
  
  .popup-song-cover {
    width: 36px;
    height: 36px;
    margin-right: 12px;
  }
  
  .popup-song-info {
    margin-right: 12px;
  }
  
  .popup-song-title {
    font-size: 13px;
  }
  
  .popup-song-artist {
    font-size: 11px;
  }
  
  .popup-song-duration {
    font-size: 11px;
    min-width: 28px;
  }
}
</style>
  </head>

  <body>
    <div id="pageWrapper">
      <nav id="navbar" class="glass-effect">
        <div class="navbar-content">
          <div class="navbar-left">
            <button class="menu-trigger" id="menu-trigger" title="Menu">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
              </svg>
            </button>
          </div>

          <div class="navbar-center" id="now-playing-area" title="Click to open Now Playing">
            <div class="now-playing-display">
              <div id="navbar-logo" class="flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.369 4.369 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z" />
                </svg>
              </div>

              <img id="navbar-album-cover" src="" alt="Album Cover" class="hidden object-cover" />

              <div class="now-playing-info">
                <div id="navbar-song-title" class="truncate">No song playing</div>
                <div id="navbar-artist" class="truncate">Select a song to get started</div>
              </div>

              <div class="play-indicator" id="play-indicator"></div>
            </div>
          </div>

          <div class="navbar-right">
            <div class="nav-controls">
              <button class="nav-control-btn" id="prev-btn-navbar" title="Previous Track">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M8.445 14.832A1 1 0 0010 14v-2.798l5.445 3.63A1 1 0 0017 14V6a1 1 0 00-1.555-.832L10 8.798V6a1 1 0 00-1.555-.832l-6 4a1 1 0 000 1.664l6 4z" />
                </svg>
              </button>

              <button class="nav-control-btn play-pause" id="play-pause-navbar" title="Play/Pause">
                <svg id="play-icon-navbar" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                </svg>
                <svg id="pause-icon-navbar" class="w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                </svg>
              </button>

              <button class="nav-control-btn" id="next-btn-navbar" title="Next Track">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4A1 1 0 0010 6v2.798L4.555 5.168z" />
                </svg>
              </button>
            </div>
            <button id="theme-toggle" title="Toggle Theme" class="ml-2">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path d="M17.293 13.293A8 8 0 116.707 2.707a8.001 8.001 0 1010.586 10.586z" />
              </svg>
            </button>
          </div>
        </div>
      </nav>

      <div class="dropdown-menu" id="dropdown-menu">
        <div class="dropdown-header">
          <h3 class="dropdown-title">Music Library</h3>
          <button class="dropdown-close" id="dropdown-close">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                clip-rule="evenodd"
              />
            </svg>
          </button>
        </div>

        <div class="dropdown-section">
          <h4 class="section-title">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" />
            </svg>
            Favorites
          </h4>

          <div class="dropdown-item" id="favorite-songs">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Favorite Songs</div>
              <div class="dropdown-item-subtitle">Your liked tracks</div>
            </div>
            <div class="dropdown-item-badge" id="favorite-songs-count">0</div>
          </div>

          <div class="dropdown-item" id="favorite-artists">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9 12a3 3 0 00-3-3H2a1 1 0 100 2h4a1 1 0 011 1v.5a1 1 0 102 0V12zm3-8a3 3 0 100 6 3 3 0 000-6zm-1 4a1 1 0 11-2 0 1 1 0 012 0z" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Favorite Artists</div>
              <div class="dropdown-item-subtitle">Artists you follow</div>
            </div>
            <div class="dropdown-item-badge" id="favorite-artists-count">0</div>
          </div>
        </div>

        <div class="dropdown-section">
          <h4 class="section-title">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" />
            </svg>
            Library
          </h4>

          <div class="dropdown-item" id="recently-played">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Recent Plays</div>
              <div class="dropdown-item-subtitle">Recently played songs</div>
            </div>
            <div class="dropdown-item-badge" id="recent-count">0</div>
          </div>

          <div class="dropdown-item" id="queue-view">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Up Next</div>
              <div class="dropdown-item-subtitle">Songs in queue</div>
            </div>
            <div class="dropdown-item-badge" id="queue-count">0</div>
          </div>
        </div>

        <div class="dropdown-section">
          <h4 class="section-title">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" />
            </svg>
            Playlists
          </h4>

          <div class="dropdown-item" id="create-playlist">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Create Playlist</div>
              <div class="dropdown-item-subtitle">Make a new playlist</div>
            </div>
          </div>

          <div id="playlists-list">
            <div class="empty-state" id="playlists-empty">
              <div class="empty-state-icon">
                <svg class="w-full h-full" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" />
                </svg>
              </div>
              <div class="empty-state-text">
                No playlists yet.<br />
                Create your first playlist!
              </div>
            </div>
          </div>
        </div>

        <div class="dropdown-section">
          <h4 class="section-title">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z" />
            </svg>
            Actions
          </h4>

          <div class="dropdown-item" id="shuffle-all">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Shuffle All</div>
              <div class="dropdown-item-subtitle">Play all songs randomly</div>
            </div>
          </div>
        </div>

        <div class="dropdown-section">
          <h4 class="section-title">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z"
                clip-rule="evenodd"
              />
            </svg>
            Settings
          </h4>

          <div class="dropdown-item" id="app-settings">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"
                />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">Preferences</div>
              <div class="dropdown-item-subtitle">App settings & options</div>
            </div>
          </div>

          <div class="dropdown-item" id="about-app">
            <div class="dropdown-item-icon">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="dropdown-item-content">
              <div class="dropdown-item-title">About</div>
              <div class="dropdown-item-subtitle">Version & information</div>
            </div>
          </div>
        </div>
      </div>

      <div class="now-playing-popup" id="now-playing-popup">
        
        
        <div id="offcanvas-handle" class="offcanvas-handle flex items-center justify-center py-1">
          <div class="w-10 h-1 bg-gray-500 rounded-full"></div>
        </div>

        <div class="popup-tabs">
          <button class="popup-tab active" data-tab="now-playing">Now Playing</button>
          <button class="popup-tab" data-tab="queue">Up Next</button>
          <button class="popup-tab" data-tab="recent">Recent Plays</button>
        </div>
        
        
        
        
        
        
        <div class="popup-header">
          <button class="popup-close" id="popup-close">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>


        <div class="popup-content">
          <div class="popup-tab-content" data-tab="now-playing">
            <img id="popup-album-cover" src="" alt="Album Cover" class="popup-album-cover" />

            <div class="popup-song-info">
              <h4 id="popup-song-title" class="popup-song-title"></h4>
              <p id="popup-artist-name" class="popup-artist-name"></p>
              <p id="popup-album-name" class="popup-album-name"></p>
            </div>

            <div class="popup-progress">
              <div class="progress-time">
                <span id="popup-current-time">0:00</span>
                <span id="popup-total-time">0:00</span>
              </div>
              <div class="popup-progress-bar" id="popup-progress-bar">
                <div class="popup-progress-fill" id="popup-progress-fill" style="width: 0%;">
                  <div class="popup-progress-thumb" id="popup-progress-thumb"></div>
                </div>
              </div>
            </div>

            <div class="popup-controls">
              <button class="popup-control-btn" id="popup-shuffle-btn" title="Shuffle">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                </svg>
              </button>

              <button class="popup-control-btn" id="popup-prev-btn" title="Previous">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M8.445 14.832A1 1 0 0010 14v-2.798l5.445 3.63A1 1 0 0017 14V6a1 1 0 00-1.555-.832L10 8.798V6a1 1 0 00-1.555-.832l-6 4a1 1 0 000 1.664l6 4z" />
                </svg>
              </button>

              <button class="popup-control-btn play-pause" id="popup-play-pause-btn">
                <svg id="popup-play-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                </svg>
                <svg id="popup-pause-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                </svg>
              </button>

              <button class="popup-control-btn" id="popup-next-btn" title="Next">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4A1 1 0 0010 6v2.798L4.555 5.168z" />
                </svg>
              </button>

              <button class="popup-control-btn" id="popup-repeat-btn" title="Repeat">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                </svg>
              </button>
            </div>

            <div class="popup-actions">
              <button class="popup-action-btn" id="popup-favorite-btn" title="Add to Favorites">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" />
                </svg>
              </button>

              <button class="popup-action-btn" id="popup-queue-btn" title="View Queue">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" />
                </svg>
              </button>

              <button class="popup-action-btn" id="popup-share-btn" title="Share">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z" />
                </svg>
              </button>

              <button class="popup-action-btn" id="popup-more-btn" title="More Options">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z" />
                </svg>
              </button>
            </div>
          </div>

          <div class="popup-tab-content" data-tab="queue">
            <ul id="queue-list" class="popup-song-list">
              <li class="empty-state">Queue is empty</li>
            </ul>
          </div>

          <div class="popup-tab-content" data-tab="recent">
            <ul id="recent-list" class="popup-song-list">
              <li class="empty-state">No recently played songs</li>
            </ul>
          </div>
        </div>
      </div>

      <div id="mainArea" class="pt-4">
        <main id="main-container" class="content-container max-w-6xl mx-auto pb-24">
          <div id="contentWrapper" class="relative">
            <nav id="breadcrumb-nav" class="breadcrumb-navigation flex items-center text-fg-muted">
              <ol class="breadcrumb-list flex items-center flex-wrap"></ol>
            </nav>

            <div id="dynamic-content">
              <div class="text-center py-8 md:py-12">
                <h1 class="text-4xl md:text-5xl font-bold mb-6 gradient-text">Discover Amazing Music</h1>
                <p class="text-lg md:text-xl text-gray-400 mb-8 md:mb-12 max-w-2xl mx-auto">Explore artists, albums, and songs from your personal library with an immersive listening experience</p>
              </div>
              <h2 class="text-2xl md:text-3xl font-bold mb-6 md:mb-8 px-4">Featured Artists</h2>
              <div id="featured-artists" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 md:gap-8 px-4"></div>
            </div>

            <div id="content-loading" class="absolute inset-0 bg-bg-default bg-opacity-80 backdrop-blur-sm flex items-center justify-center hidden">
              <div class="loading-animation">
                <div class="spinner-container">
                  <div class="spinner"></div>
                </div>
                <p class="mt-4 text-fg-muted">Loading content...</p>
              </div>
            </div>
          </div>
        </main>
      </div>

      <button class="floating-add-button" id="floating-add-button" title="Create Playlist">
        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
        </svg>
      </button>

      <div id="popover-portal" class="popover-portal"></div>

      <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/preline@2.0.3/dist/preline.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/tippy.js@6.3.7/dist/tippy.umd.min.js"></script>

      <script type="module" src="./pageModules/global.js"></script>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
          let nav = document.querySelector('.breadcrumb-navigation');
          let artistTop = document.querySelector('.artistTop');
          
          if (nav && artistTop) {
              let observer = new IntersectionObserver(function(entries) {
                  entries.forEach(function(entry) {
                      nav.classList.toggle('stuck', !entry.isIntersecting);
                      artistTop.classList.toggle('stuck', !entry.isIntersecting);
                  });
              }, { 
                  threshold: 0, 
                  rootMargin: '-1px 0px 0px 0px'
              });

              observer.observe(artistTop);
          }
      });
    </script>

    <style>
      #install-prompt-modal,
      #open-app-banner {
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
      }
      #install-prompt-modal {
        transform: translateY(20px) scale(0.95);
      }
      #open-app-banner {
        transform: translateY(-100%);
      }
      body.show-install-modal #install-prompt-modal,
      body.show-open-banner #open-app-banner {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      body.show-open-banner #open-app-banner {
        transform: translateY(0);
      }
    </style>
    
    <div id="open-app-banner" class="fixed top-0 left-0 right-0 bg-gray-800 p-4 text-center shadow-lg opacity-0 z-50">
      <p class="text-white">Already have the app? <a href="/" id="open-app-link" class="font-bold text-blue-400 hover:underline">Open it here!</a></p>
    </div>

    <div id="install-prompt-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 opacity-0 pointer-events-none z-50">
      <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-sm p-8 text-center">
        <div class="flex justify-center mb-6">
          <div class="bg-gray-700 p-4 rounded-full">
            <svg class="w-12 h-12 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
            </svg>
          </div>
        </div>
        <h2 class="text-2xl font-bold mb-2 text-white">Install Our App</h2>
        <p class="text-gray-400 mb-6">Get the full experience on your device. It's fast and free!</p>
        <div class="flex flex-col space-y-3">
          <button id="install-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 w-full">
            Install App
          </button>
          <button id="dismiss-button" class="bg-gray-700 hover:bg-gray-600 text-gray-300 font-bold py-3 px-4 rounded-lg transition w-full">
            Not Now
          </button>
        </div>
      </div>
    </div>
    <script src="./dev/scripts.js"></script>
    <script>
      let deferredPrompt;
      let installModal = document.getElementById("install-prompt-modal");
      let installButton = document.getElementById("install-button");
      let dismissButton = document.getElementById("dismiss-button");

      window.addEventListener("beforeinstallprompt", function(e) {
        e.preventDefault();
        deferredPrompt = e;
        console.log("`beforeinstallprompt` event was fired.");
        showInstallPrompt();
      });

      function showInstallPrompt() {
        if (installModal) {
          document.body.classList.add("show-install-modal");
          installModal.style.pointerEvents = "auto";
        }
      }

      function hideInstallPrompt() {
        if (installModal) {
          document.body.classList.remove("show-install-modal");
          installModal.style.pointerEvents = "none";
        }
      }

      if (installButton) {
        installButton.addEventListener("click", async function() {
          hideInstallPrompt();
          if (deferredPrompt) {
            deferredPrompt.prompt();
            let { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to the install prompt: ${outcome}`);
            deferredPrompt = null;
          }
        });
      }

      if (dismissButton) {
        dismissButton.addEventListener("click", function() {
          hideInstallPrompt();
        });
      }

      let openAppBanner = document.getElementById("open-app-banner");

      window.addEventListener("DOMContentLoaded", function() {
        if (window.matchMedia("(display-mode: standalone)").matches) {
          console.log("App is running in standalone mode.");
        } else {
          if ("getInstalledRelatedApps" in navigator) {
            navigator.getInstalledRelatedApps().then(function(relatedApps) {
              if (relatedApps.length > 0) {
                console.log("PWA is installed.");
                document.body.classList.add("show-open-banner");
              } else {
                console.log("PWA is not installed.");
              }
            });
          }
        }
      });

      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function() {
          navigator.serviceWorker
            .register("/service-worker.js")
            .then(function(registration) {
              console.log("Service Worker registered with scope:", registration.scope);
            })
            .catch(function(err) {
              console.error("Service Worker registration failed:", err);
            });
        });
      }
    </script>
  </body>
</html>
